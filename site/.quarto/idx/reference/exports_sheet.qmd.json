{"title":"Exports sheet","markdown":{"yaml":{"title":"Exports sheet","description":"Define export buttons and files","categories":["Setup","Sheet"]},"headingText":"Export number","containsRefs":false,"markdown":"\n\n![](../reference/images/im-088-exports-sheet.png){fig-align=\"center\"}\n\nIt is possible to predefine exports, such as a specific export for a given MoH. The preparation of exports is done in two different sheets:\n\n- In the *Exports* sheet you define the export: metadata, button label, exported file name, type of headers etc. \n\n- In the *Dictionary* sheet you define which variable is exported in each export, and in which order  \n\nA sheet in the **linelist file** corresponds to a sheet in the **exported file**.\n\n::: {.callout-warning}\nWithout some of export metadata, it may simply not be possible to generate an export or it may contain only the variables selected, in raw format.\n:::\n\n\n\nOne line corresponds to one export. The exports are numbered from 1 to how many exports are available.\n\nIn line \"1\", we define the parameters for export 1, whose variables to be exported have been defined in the *Dictionary* sheet in the \"Export 1\" column, etc.\n\n![](../reference/images/im-089-export-number.png){fig-align=\"center\"}\n\n![](../reference/images/im-090-export-number.png){fig-align=\"center\"}\n\nNote that you can use the \"*Add rows to table in current sheet*\" button or the \"*Resize tables in current sheet*\" button to add more exports or removed empty rows (see the [ribbon help](../reference/ribbons_setup.qmd).\n\n\n## Status\n\nThis is an *active/inactive* drop-down menu field. It is used to activate or deactivate an export button.\n\nExample:\n\nDefinition in the **setup file**:\n\n![](../reference/images/im-091-status-exports-sheet.png){fig-align=\"center\"}\n\nDisplay in the **linelist file**:\n\n![](../reference/images/im-092-status-exports-sheet.png){fig-align=\"center\"}\n\n## Label button\n\nThis is a free text field that contains the label of the export button in the linelist. It should be fairly concise or it may overflow the button box.\n\nExample :\n\nDefinition in the **setup file**:\n\n![](../reference/images/im-093-label-button-exports-sheet.png){fig-align=\"center\"}\n\nDisplay in the **linelist file**:\n\n![](../reference/images/im-094-label-button-exports-sheet.png){fig-align=\"center\"}\n\n## File format\n\nThis is a dropdown menu that allows choosing between the **.xlsx** and **.xlsb** file format for the exported file.\n\n\n## File name\n\nThis is a free text field used to define the **name** of the export. \n\nYou can either define **fixed** export names (ex: \"export_moh\") or **dynamic** exports names, that use values collected from variables in the linelist (such as the country, the section etc.).\n\nFor dynamic names, you can only use variables that contain only one value (**vlist1D** variables), usually defined in the \"Info\" sheet of the linelist.\n\n\n### Rules to create a name\n\n-   **Character strings** passed to this field must be enclosed in inverted commas like these: *\"a character string*\"\n-   **Variable names** passed to this field must be naked (not surrounded by inverted comas), similarly to how we refer to variables in the *Dictionary* sheet columns.\n-   Different components of the name are separated by '*+*', which will create names where the components are separated by '*\\_\\_*'.\n-   No need to add a date to the export: the date and time at which an export is made is appended at the end of the name automatically.\n-   If the export is to be password protected (see below), the public key for opening the file will be included in the name.\n\n### Example\n\n![](../reference/images/im-095-example-file-name.png){fig-align=\"center\"}\n\nHere, the pieces in green, surrounded by inverted comas are fixed bits of texts (character strings). The blue pieces are *vlist1D variables* that were defined for that linelist (in the Info sheet, hence their suffixes).\n\nThis name specification will result in the following export names, depending on where the linelist is used (hence depending on how they filled the metadata):\n\n-   MNG_linelist\\_\\_MNG24\\_\\_SSD\\_\\_MSF-OCP\\_\\_Aweil\\_\\_anonyme\\_\\_vb-1003\\_\\_20240617-1901.xlsb if the linelist was used by OCP in Aweil (South Sudan)\n-   MNG_linelist\\_\\_MNG24\\_\\_NER\\_\\_WaCa\\_\\_Maradi\\_\\_anonyme\\_\\_vb-2035\\_\\_20240617-1903.xlsb if the linelist was used by WaCa in Maradi (Niger)\n-   ...\n\n\n::: {.callout-note}\nIf a variable is referred to in the name but remains empty in the linelist, the **name of the variable** is used as a placeholder. In the example above, if the data encoder filled none of the variables in the metadata, the created file would have the following name:\n\nMNG_linelist\\_\\_info_outbreak_code\\_\\_info_country_code\\_\\_info_organisation\\_\\_info_facility_name\\_\\_anonyme\\_\\_vb-1003\\_\\_20240617-1906.xlsb\n:::\n\n## Password\n\nThis is a *yes/no* drop-down field that is used to define whether or not the export should be password-protected.\n\nIf so, the password will be displayed automatically when the export is created.\n\nExample:\n\nDefinition in the **setup file**:\n\n![](../reference/images/im-096-example-password.png){fig-align=\"center\"}\n\nDisplay in the **linelist file**:\n\n![](../reference/images/im-097-example-password.png){fig-align=\"center\"}\n\n![](../reference/images/im-098-example-password.png){fig-align=\"center\"}\n\n\n## Include personal identifiers\n\nThis is a *yes/no* dropdown menu which controls whether *variables* that are tagged as [Personal identifier](#sec-personal-identifiers) in the *Dictionary* sheet should be included in the export.^[Remember, in the *Dictionary* sheet, any variable with *anything* written in the export columns will be exported in the corresponding exports (even if it is written \"no\").]\n\nThe column defaults to \"*no*\". \n\n\n## Include P-code\n\nThis is a *yes/no* drop-down field that controls whether the hidden columns that contains processed geographic data such as P-codes should be exported in addition to the raw data columns.^[These columns are automatically calculated when *geo* and *hf* variables are created in the linelist. They contain concatenated administrative levels at different scales, and p-codes. They are used for creating maps.]\n\n\n## Header format\n\nThis is a *variables names/variables labels* drop-down menu field. It allows you to define whether you want the column headings in the export to correspond to the *variable names*, their *labels*, or both.\n\n\n::: {.callout-tip title=\"Tip: choosing the header format\"}\nIf you create an export for analyses purpose, use the *variable names* to avoid having to format and rename when importing in your favourite statistical software. \n\nIf you are exporting data to the MoH or other partners, it might be easier for them to have the *variables labels*, which are more descriptive about the content of the variable.\n:::\n\n**Example**:\n\nDefinition in the **setup file**:\n\n![](../reference/images/im-099-example-header-format.png){fig-align=\"center\"}\n\nDisplay in export:\n\n![](../reference/images/im-100-example-header-format.png){fig-align=\"center\"}\n\nDefinition in the **setup file**:\n\n![](../reference/images/im-101-example-header-format.png){fig-align=\"center\"}\n\nDisplay in export:\n\n![](../reference/images/im-102-example-header-format.png){fig-align=\"center\"}\n\n\n## Export Metadata Sheets\n\nThis is a *yes/no* drop-down field. By selecting \"*yes*\", you decide that in addition to the data to be exported, you will also export:\n\n-   The \"*Dictionary*\" sheet\n-   The \"*Choices*\" sheet\n-   A metadata sheet^[we are not speaking of the sheet usually created for linelists that contains variables to collect metadata about the project (MSF section, disease, facility name...), but of hidden linelist metadata (when the file was compiled, language, version etc.)]\n\n\n## Export Translation\n\nThis is a *yes/no* drop-down field. Selecting \"*yes*\" means that, in addition to the data to be exported, we will also have the sheet containing the translations.\n\n\n## Export Analysis Sheet\n\nThis is a *yes/no* drop-down field. By selecting '*yes*', you decide that in addition to the data to be exported, you will also export all the analysis tables (but not the graphs).\n\n\n::: {.callout-tip}\nIt is also possible to export analysis tables directly from the linelist using the \"*Export analyses*\" button.\n:::\n","srcMarkdownNoYaml":"\n\n![](../reference/images/im-088-exports-sheet.png){fig-align=\"center\"}\n\nIt is possible to predefine exports, such as a specific export for a given MoH. The preparation of exports is done in two different sheets:\n\n- In the *Exports* sheet you define the export: metadata, button label, exported file name, type of headers etc. \n\n- In the *Dictionary* sheet you define which variable is exported in each export, and in which order  \n\nA sheet in the **linelist file** corresponds to a sheet in the **exported file**.\n\n::: {.callout-warning}\nWithout some of export metadata, it may simply not be possible to generate an export or it may contain only the variables selected, in raw format.\n:::\n\n\n## Export number\n\nOne line corresponds to one export. The exports are numbered from 1 to how many exports are available.\n\nIn line \"1\", we define the parameters for export 1, whose variables to be exported have been defined in the *Dictionary* sheet in the \"Export 1\" column, etc.\n\n![](../reference/images/im-089-export-number.png){fig-align=\"center\"}\n\n![](../reference/images/im-090-export-number.png){fig-align=\"center\"}\n\nNote that you can use the \"*Add rows to table in current sheet*\" button or the \"*Resize tables in current sheet*\" button to add more exports or removed empty rows (see the [ribbon help](../reference/ribbons_setup.qmd).\n\n\n## Status\n\nThis is an *active/inactive* drop-down menu field. It is used to activate or deactivate an export button.\n\nExample:\n\nDefinition in the **setup file**:\n\n![](../reference/images/im-091-status-exports-sheet.png){fig-align=\"center\"}\n\nDisplay in the **linelist file**:\n\n![](../reference/images/im-092-status-exports-sheet.png){fig-align=\"center\"}\n\n## Label button\n\nThis is a free text field that contains the label of the export button in the linelist. It should be fairly concise or it may overflow the button box.\n\nExample :\n\nDefinition in the **setup file**:\n\n![](../reference/images/im-093-label-button-exports-sheet.png){fig-align=\"center\"}\n\nDisplay in the **linelist file**:\n\n![](../reference/images/im-094-label-button-exports-sheet.png){fig-align=\"center\"}\n\n## File format\n\nThis is a dropdown menu that allows choosing between the **.xlsx** and **.xlsb** file format for the exported file.\n\n\n## File name\n\nThis is a free text field used to define the **name** of the export. \n\nYou can either define **fixed** export names (ex: \"export_moh\") or **dynamic** exports names, that use values collected from variables in the linelist (such as the country, the section etc.).\n\nFor dynamic names, you can only use variables that contain only one value (**vlist1D** variables), usually defined in the \"Info\" sheet of the linelist.\n\n\n### Rules to create a name\n\n-   **Character strings** passed to this field must be enclosed in inverted commas like these: *\"a character string*\"\n-   **Variable names** passed to this field must be naked (not surrounded by inverted comas), similarly to how we refer to variables in the *Dictionary* sheet columns.\n-   Different components of the name are separated by '*+*', which will create names where the components are separated by '*\\_\\_*'.\n-   No need to add a date to the export: the date and time at which an export is made is appended at the end of the name automatically.\n-   If the export is to be password protected (see below), the public key for opening the file will be included in the name.\n\n### Example\n\n![](../reference/images/im-095-example-file-name.png){fig-align=\"center\"}\n\nHere, the pieces in green, surrounded by inverted comas are fixed bits of texts (character strings). The blue pieces are *vlist1D variables* that were defined for that linelist (in the Info sheet, hence their suffixes).\n\nThis name specification will result in the following export names, depending on where the linelist is used (hence depending on how they filled the metadata):\n\n-   MNG_linelist\\_\\_MNG24\\_\\_SSD\\_\\_MSF-OCP\\_\\_Aweil\\_\\_anonyme\\_\\_vb-1003\\_\\_20240617-1901.xlsb if the linelist was used by OCP in Aweil (South Sudan)\n-   MNG_linelist\\_\\_MNG24\\_\\_NER\\_\\_WaCa\\_\\_Maradi\\_\\_anonyme\\_\\_vb-2035\\_\\_20240617-1903.xlsb if the linelist was used by WaCa in Maradi (Niger)\n-   ...\n\n\n::: {.callout-note}\nIf a variable is referred to in the name but remains empty in the linelist, the **name of the variable** is used as a placeholder. In the example above, if the data encoder filled none of the variables in the metadata, the created file would have the following name:\n\nMNG_linelist\\_\\_info_outbreak_code\\_\\_info_country_code\\_\\_info_organisation\\_\\_info_facility_name\\_\\_anonyme\\_\\_vb-1003\\_\\_20240617-1906.xlsb\n:::\n\n## Password\n\nThis is a *yes/no* drop-down field that is used to define whether or not the export should be password-protected.\n\nIf so, the password will be displayed automatically when the export is created.\n\nExample:\n\nDefinition in the **setup file**:\n\n![](../reference/images/im-096-example-password.png){fig-align=\"center\"}\n\nDisplay in the **linelist file**:\n\n![](../reference/images/im-097-example-password.png){fig-align=\"center\"}\n\n![](../reference/images/im-098-example-password.png){fig-align=\"center\"}\n\n\n## Include personal identifiers\n\nThis is a *yes/no* dropdown menu which controls whether *variables* that are tagged as [Personal identifier](#sec-personal-identifiers) in the *Dictionary* sheet should be included in the export.^[Remember, in the *Dictionary* sheet, any variable with *anything* written in the export columns will be exported in the corresponding exports (even if it is written \"no\").]\n\nThe column defaults to \"*no*\". \n\n\n## Include P-code\n\nThis is a *yes/no* drop-down field that controls whether the hidden columns that contains processed geographic data such as P-codes should be exported in addition to the raw data columns.^[These columns are automatically calculated when *geo* and *hf* variables are created in the linelist. They contain concatenated administrative levels at different scales, and p-codes. They are used for creating maps.]\n\n\n## Header format\n\nThis is a *variables names/variables labels* drop-down menu field. It allows you to define whether you want the column headings in the export to correspond to the *variable names*, their *labels*, or both.\n\n\n::: {.callout-tip title=\"Tip: choosing the header format\"}\nIf you create an export for analyses purpose, use the *variable names* to avoid having to format and rename when importing in your favourite statistical software. \n\nIf you are exporting data to the MoH or other partners, it might be easier for them to have the *variables labels*, which are more descriptive about the content of the variable.\n:::\n\n**Example**:\n\nDefinition in the **setup file**:\n\n![](../reference/images/im-099-example-header-format.png){fig-align=\"center\"}\n\nDisplay in export:\n\n![](../reference/images/im-100-example-header-format.png){fig-align=\"center\"}\n\nDefinition in the **setup file**:\n\n![](../reference/images/im-101-example-header-format.png){fig-align=\"center\"}\n\nDisplay in export:\n\n![](../reference/images/im-102-example-header-format.png){fig-align=\"center\"}\n\n\n## Export Metadata Sheets\n\nThis is a *yes/no* drop-down field. By selecting \"*yes*\", you decide that in addition to the data to be exported, you will also export:\n\n-   The \"*Dictionary*\" sheet\n-   The \"*Choices*\" sheet\n-   A metadata sheet^[we are not speaking of the sheet usually created for linelists that contains variables to collect metadata about the project (MSF section, disease, facility name...), but of hidden linelist metadata (when the file was compiled, language, version etc.)]\n\n\n## Export Translation\n\nThis is a *yes/no* drop-down field. Selecting \"*yes*\" means that, in addition to the data to be exported, we will also have the sheet containing the translations.\n\n\n## Export Analysis Sheet\n\nThis is a *yes/no* drop-down field. By selecting '*yes*', you decide that in addition to the data to be exported, you will also export all the analysis tables (but not the graphs).\n\n\n::: {.callout-tip}\nIt is also possible to export analysis tables directly from the linelist using the \"*Export analyses*\" button.\n:::\n"},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":"auto","echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"engine":"markdown"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","toc":true,"toc-depth":5,"output-file":"exports_sheet.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","appendix-view-license":"View License","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","tools-share":"Share","tools-download":"Download","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words","listing-page-filter":"Filter","draft":"Draft"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.6.42","theme":["flatly","../styles.scss"],"toc-expand":1,"toc-title":"Table of content","citations-hover":true,"footnotes-hover":true,"title":"Exports sheet","description":"Define export buttons and files","categories":["Setup","Sheet"]},"extensions":{"book":{"multiFile":true}}}},"projectFormats":["html"]}